r = 0.01
N = 50;
L = 1;
E = 1;
#K = input("Spring constant: ");
q = 1;
I = (pi*r^4)/4;
Mhat = zeros(N-1,1);
A = zeros(N+3,N+3);
h = L/N;
X = linspace(0,L,N+1);
Y = [0.00000;
         -0.00000;
     -24456.38518;
     -72381.12164;
    -142806.54734;
    -234785.37205;
    -347390.67739;
    -479715.91679;
    -630874.91554;
    -800001.87075;
    -986251.35135;
   -1188798.29813;
   -1406838.02369;
   -1639586.21246;
   -1886278.92073;
   -2146172.57661;
   -2418543.98002;
   -2702690.30273;
   -2997929.08837;
   -3303598.25235;
   -3619056.08196;
   -3943681.23628;
   -4276872.74626;
   -4618050.01467;
   -4966652.81610;
   -5322141.29699;
   -5683995.97561;
   -6051717.74204;
   -6424827.85823;
   -6802867.95794;
   -7185400.04676;
   -7572006.50212;
   -7962290.07329;
   -8355873.88136;
   -8752401.41925;
   -9151536.55174;
   -9552963.51540;
   -9956386.91867;
  -10361531.74181;
  -10768143.33690;
  -11175987.42787;
  -11584850.11047;
  -11994537.85230;
  -12404877.49278;
  -12815716.24316;
  -13226921.68653;
  -13638381.77780;
  -14050004.84374;
  -14461719.58293;
  -14873475.06578;
  -15285240.73455;
         -0.00000;
          0.00000];
tol = 0.0001;
for K = 1:10  
f = zeros(N+3,1);
for i = 1:N-1
  Mhat(i) = -(1/2)*q*(L-X(i+1))^2;
end
A(1,1) = 1;
A(2,1) = -1/h;
A(2,2) = 1/h;
for j = 3:N+1
  A(j,(j-2:j)) = [((E*I)/h^2) (-(2*E*I)/h^2) ((E*I)/h^2)];
  A(j,(N+2:N+3)) = [(-(L-X(j-1))) (-1)];
endfor
A(N+2,N+2) = 1;
A(N+3,N+3) = 1;
while true
f(1) = Y(1);
f(2) = (Y(2)-Y(1))/h;
f(N+2) = Y(N+2) + K*(Y(N+1))^3;
f(N+3) = Y(N+3);
for i = 2:N
  f(i+1) = E*I*(Y(i+1)+Y(i-1)-2*Y(i))/h^2 - Y(N+2)*(L-X(i))-Y(N+3)- Mhat(i-1);
end
A(N+2,N+1) = 3*K*(Y(N+1))^2;
Y_pre = Y;
Y = Y - A\f;
if(norm(Y-Y_pre)<tol && norm(f)<tol)
  break;
end
end
#plot(X,Y(1:N+1));
#hold on;
Ytip(K)=Y(N+1);
end
plot(linspace(1,10,10),Ytip);